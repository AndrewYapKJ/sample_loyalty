@inherits LayoutComponentBase
@using Gussmann.FrontendServer.Shared

<div class="app-root">
    <header class="topbar" role="banner">
        <div class="topbar-inner">
            <button class="sidebar-toggle" aria-expanded="@(isCollapsed ? "false" : "true")"
                @onclick="() => HandleSidebarToggle(!isCollapsed)">
                <span class="sr-only">Toggle sidebar</span>
                <span class="icon">â˜°</span>
            </button>
            <div class="brand">My App</div>
            <div class="topbar-actions">
                <!-- place for user avatar / actions -->
            </div>
        </div>
    </header>

    <div class="page">
        <aside class="sidebar @(isCollapsed ? "collapsed" : "")" role="navigation" aria-label="Main navigation">
            <NavMenu IsCollapsed="isCollapsed" />
        </aside>

        <main class="main @(isCollapsed ? "sidebar-collapsed" : "")" role="main">
            <div class="content">
                @Body
            </div>
        </main>
    </div>
</div>

<div id="blazor-error-ui" data-nosnippet>
    An unhandled error has occurred.
    <a href="." class="reload">Reload</a>
    <span class="dismiss">ðŸ—™</span>
</div>

@code {
    private bool isCollapsed = false;

    [Inject]
    private ILogger<MainLayout> Logger { get; set; } = null!;

    private void HandleSidebarToggle(bool collapsed)
    {
        Logger.LogInformation("HandleSidebarToggle called with: {Collapsed}", collapsed);
        isCollapsed = collapsed;
        Logger.LogInformation("MainLayout isCollapsed set to: {IsCollapsed}", isCollapsed);
        InvokeAsync(StateHasChanged);
    }
}
